DROP TABLE TRAVELER cascade constraints;
DROP TABLE DEPENDENTS cascade constraints;
DROP TABLE RT_PCRTEST cascade constraints;
DROP TABLE AUTHORIZED_OFFICER cascade constraints;
DROP TABLE WRISTBAND cascade constraints;
DROP TABLE APPLICATION cascade constraints;
DROP TABLE CHECKIN cascade constraints;
DROP TABLE QUARANTINEPATIENT cascade constraints;
DROP TABLE SYMPTOMS cascade constraints;
DROP TABLE TYPEOFEXPOSURE cascade constraints;

CREATE TABLE APPLICATION (
    userName VARCHAR(15) NOT NULL,
    MySJID CHAR(5) NOT NULL,
    userPhoneNo CHAR(12),
    userICorPassportNo CHAR(12),
    userAddress VARCHAR2(50) NOT NULL,
    Email VARCHAR2(50),
    CONSTRAINT APPLICATION_pk PRIMARY KEY (MySJID)

);
CREATE TABLE CHECKIN (
    visitedlocation VARCHAR(25) NOT NULL,
    visiteDate TIMESTAMP(00) NOT NULL,
    visitedRisk CHAR(10) NOT NULL,
    MySJID CHAR(5) NOT NULL,
    CONSTRAINT fk_MSJID FOREIGN KEY(MySJID) REFERENCES APPLICATION(MySJID)
);

CREATE TABLE TRAVELER (
    TravellerID CHAR(5) NOT NULL,
    Name VARCHAR2(20) NOT NULL,
    TravellerType CHAR(10) NOT NULL CHECK (TravellerType IN ('CITIZENS', 'FOREIGNER')),
    IC CHAR(12) CHECK (IC >=0),
    PassportNo CHAR(12) CHECK (PassportNo >=0),
    PhoneNo CHAR(12)NOT NULL,
    Address VARCHAR2(50) NOT NULL,
    visitedCountry VARCHAR2(20) NOT NULL,
    visitedDATE DATE NOT NULL,
    relativesName VARCHAR2(20) NOT NULL,
    relativesPhoneNo CHAR(12)NOT NULL,
    wristbandID  CHAR(5) NOT NULL,
    TestID CHAR(5) NOT NULL,
    MySJID CHAR(5) NOT NULL,
    CONSTRAINT travelType_constraint CHECK ((TravellerType = 'CITIZENS' and IC IS NOT NULL) 
                                         or (TravellerType='FOREIGNER' and PassportNo IS NOT NULL )),
    CONSTRAINT fk_MSJIDa FOREIGN KEY(MySJID) REFERENCES APPLICATION(MySJID),
    CONSTRAINT TRAVELER_pk PRIMARY KEY (TravellerID)    
);

CREATE TABLE QUARANTINEPATIENT(
    patientID CHAR(4),
    MySJID CHAR(5) NOT NULL,
    iC CHAR(12),
    passportNo CHAR(20),
    name VARCHAR2(20) NOT NULL,
    phoneNumber CHAR(10),
    address VARCHAR2(100),
    arrivalDate DATE,
    transportType VARCHAR2(20) NOT NULL CHECK (transportType IN ('LOCAL','FOREIGN')),
    transportNo CHAR(5),
    ExposureID CHAR(4),
    wristbandID  CHAR(5) NOT NULL,
    TravellerID CHAR(5) NOT NULL,
    constraint transportType_constraint CHECK ((transportType = 'LOCAL' and iC IS NOT NULL ) or (transportType='FOREIGN' and passportNo IS NOT NULL))，
    CONSTRAINT  QUARANTINEPATIENT_pk PRIMARY KEY (patientID),
    CONSTRAINT fk_MSJIDb FOREIGN KEY(MySJID) REFERENCES APPLICATION(MySJID)
);

CREATE TABLE RT_PCRTEST(
    TestID CHAR(5) NOT NULL,
    TestDate DATE NOT NULL,
    TravellerID CHAR(5) NOT NULL,
    result VARCHAR2(10) NOT NULL  CHECK (result IN ('POSITIVES', 'NEGATIVES')),
    CONSTRAINT RT_PCRTEST_pk PRIMARY KEY (TestID)
);

CREATE TABLE DEPENDENTS (
    dependentsName VARCHAR2(20) NOT NULL,
    dependentsIC CHAR(12) NOT NULL,
    TravellerID CHAR(5) NOT NULL ,
    TestID CHAR(5) NOT NULL,
    CONSTRAINT DEPENDENTS_pk PRIMARY KEY (dependentsIC)
);

CREATE TABLE AUTHORIZED_OFFICER(
    OfficerID CHAR(5) NOT NULL,
    OfficerName VARCHAR2(15) NOT NULL,
    AssignDateTime Date NOT NULL,
    Designation VARCHAR2(30) NOT NULL,
    TravellerID CHAR(5) NOT NULL,
    CONSTRAINT AUTHORIZED_OFFICE_pk PRIMARY KEY (OfficerID)              
);

CREATE TABLE WRISTBAND(
    wristbandID  CHAR(5) NOT NULL ,
    TravellerID CHAR(5),
    OfficerID CHAR(5) NOT NULL,
    Condition VARCHAR2(20) NOT NULL CHECK (Condition IN ('DAMAGED', 'UNDAMAGED')),
    patientID CHAR(4),
    CONSTRAINT WRISTBAND_pk PRIMARY KEY (wristbandID)    
);

CREATE TABLE SYMPTOMS(
    fever VARCHAR2(3) NOT NULL,
    cough VARCHAR(3) NOT NULL,
    shortnessOfBreath VARCHAR(3) NOT NULL,
    patientID CHAR(4)
);

CREATE TABLE TYPEOFEXPOSURE(
    ExposureID CHAR(4) PRIMARY KEY
);

-- inserting application information
INSERT INTO APPLICATION VALUES ('Shiqi','M0001','0123456789','000113011268','15 Jalan Sri Semantan 1',NULL);
INSERT INTO APPLICATION VALUES ('Julia','M0002','0122456789','000213011268','40 Jalan Sri Semantan 1',NULL);
INSERT INTO APPLICATION VALUES ('Tom','M0003','0173456789','000313011266','40 Happy Street',NULL);
INSERT INTO APPLICATION VALUES ('Jerry','M0004',NULL,'000413011266','55 Sunflower Street','jerry123@yahoo.com');
INSERT INTO APPLICATION VALUES ('Chloe','M0005',NULL,'000913011266','66,Rose Street','chlor456@yahoo.com');
INSERT INTO APPLICATION VALUES ('Alice','M0006','0133456789','02222222','20,Jalan Bunga Semantan 1',NULL);
INSERT INTO APPLICATION VALUES ('Jonny','M0007','0123456689','01111123','11,Jalan 456Stree',NULL);
INSERT INTO APPLICATION VALUES ('Samual','M0008','0116456689','03333333','28,Jalan 789  Street',NULL);
INSERT INTO APPLICATION VALUES ('Jacob','M0009','01118456689','04444433','33,Jalan 111 Street ',NULL);
INSERT INTO APPLICATION VALUES ('Louis','M0010',NULL,'09898989','66,Jalan 122  Street ','Louis987@yahoo.com');

-- inserting checkIn information
INSERT INTO CHECKIN VALUES ('Help University', '1-FEB-2020  06:34:38 AM','Low Risk','M0001');
INSERT INTO CHECKIN VALUES ('Sunway University', '18-FEB-2020  09:30:32 AM','Low Risk','M0002');
INSERT INTO CHECKIN VALUES ('Taylor University', '22-FEB-2020  05:34:48 AM','Low Risk','M0003');
INSERT INTO CHECKIN VALUES ('Sunway Pyramid', '1-MAY-2020  06:14:38 AM','Low Risk','M0004');
INSERT INTO CHECKIN VALUES ('KLCC', '6-MAY-2020  01:34:28 AM','High Risk','M0005');
INSERT INTO CHECKIN VALUES ('Surian MRT', '26-MAY-2020  03:24:28 AM','Low Risk','M0006');
INSERT INTO CHECKIN VALUES ('Desa Part City', '19-JUNE-2020  08:30:38 AM','High Risk','M0007');
INSERT INTO CHECKIN VALUES ('Ikea', '16-JUNE-2020  10:34:38 AM','Low Risk','M0008');
INSERT INTO CHECKIN VALUES ('The Curve', '29-AUG-2020  11:54:38 AM','Low Risk','M0009');
INSERT INTO CHECKIN VALUES ('E-Curve', '18-AUG-2020  09:04:38 AM','Low Risk','M0010');

-- inserting traveler information
INSERT INTO TRAVELER VALUES ('C0001','Shiqi','CITIZENS','000113011268',NULL,'0123456789','15 Jalan Sri Semantan 1', 'MELAKA',to_DATE('2020/08/01 12:30:00', 'yyyy/mm/dd hh:mi:ss'),'John','0112345647','W0001','T0001','M0001');
INSERT INTO TRAVELER VALUES ('C0002','Julie','CITIZENS','000213011268',NULL,'0122456789','40 Jalan Sri Semantan 1', 'SABAH',to_DATE('2020/9/07 5:30:00', 'yyyy/mm/dd hh:mi:ss'),'Tom','0112446567'，'W0002','T0002','M0002');
INSERT INTO TRAVELER VALUES ('C0003','Tom','CITIZENS','000313011266',NULL,'0173456789','40 Happy Street', 'PENANG',to_DATE('2020/10/01 7:44:00', 'yyyy/mm/dd hh:mi:ss'),'Harry','0111234577'，'W0003','T0003','M0003');
INSERT INTO TRAVELER VALUES ('C0004','Jerry','CITIZENS','000413011264',NULL,'0183456789','55 Sunflower Street', 'SEMBILAN',to_DATE('2020/10/03 8:30:00', 'yyyy/mm/dd hh:mi:ss'),'Charles','0111345267'，'W0004','T0004','M0004');
INSERT INTO TRAVELER VALUES ('C0005','Chloe','CITIZENS','000613011264',NULL,'0193456789','66,Rose Street', 'Johor',to_DATE('2020/06/01 9:30:00', 'yyyy/mm/dd hh:mi:ss'),'James','0113234567'，'W0005','T0005','M0005');
INSERT INTO TRAVELER VALUES ('F0001','Alice','FOREIGNER',NULL,'01111111','0133456789','20,Jalan Bunga Semantan 1', 'CHINA',to_DATE('2020/06/01 1:30:00', 'yyyy/mm/dd hh:mi:ss'),'Zara','0112243567'，'W0006','T0006','M0006');
INSERT INTO TRAVELER VALUES ('F0002','Jonny','FOREIGNER',NULL,'01111123','0123456689','11,Jalan 456Street ', 'INDIA',to_DATE('2020/10/11 2:30:00', 'yyyy/mm/dd hh:mi:ss'),'Ana','0113524567'，'W0007','T0007','M0007');
INSERT INTO TRAVELER VALUES ('F0003','Samual','FOREIGNER',NULL,'02222323','0116456689','28,Jalan 789  Street  ', 'SINGAPURA',to_DATE('2020/10/12 3:30:00', 'yyyy/mm/dd hh:mi:ss'),'Elsa','0113445667'，'W0008','T0008','M0008');
INSERT INTO TRAVELER VALUES ('F0004','Jacob','FOREIGNER',NULL,'01111133','01118456689','33,Jalan 111 Street  ', 'THAILAND',to_DATE('2020/05/13 4:30:00', 'yyyy/mm/dd hh:mi:ss'),'Jessi','0113255677'，'W0009','T0009','M0009');
INSERT INTO TRAVELER VALUES ('F0005','Louis','FOREIGNER',NULL,'01111333','01151456689','66,Jalan 122  Street  ', 'AMERICA',to_DATE('2020/05/19 5:30:00', 'yyyy/mm/dd hh:mi:ss'),'Jennie','011324567'，'W0010','T0010','M0010');

-- inserting QUARANTINEPATIENT information
INSERT INTO QUARANTINEPATIENT  VALUES ('1001','M0001','000904342348',NULL,'xinchieng','0186142827','cheras kuala lumpur',to_DATE('2020/06/11', 'yyyy/mm/dd'),'LOCAL','10001','0001','W0001','C0001');
INSERT INTO QUARANTINEPATIENT  VALUES ('1002','M0002','000103780987',NULL,'John','0173278457','selayang',to_DATE('2020/04/19', 'yyyy/mm/dd'),'LOCAL','10002','0001','W0002','C0002');
INSERT INTO QUARANTINEPATIENT  VALUES ('1003','M0003',NULL,'110938790283','David','0132800827','semantan',to_DATE('2020/07/04', 'yyyy/mm/dd'),'FOREIGN','10003','0002','W0003','C0003');
INSERT INTO QUARANTINEPATIENT  VALUES ('1004','M0004','102904342348',NULL,'Calvin','0123457890','plaza rakyat',to_DATE('2020/06/25', 'yyyy/mm/dd'),'LOCAL','10004','0001','W0004','C0004');
INSERT INTO QUARANTINEPATIENT  VALUES ('1005','M0005',NULL,'12345678901234','Lee','0119067890','putrajaya',to_DATE('2020/08/21', 'yyyy/mm/dd'),'FOREIGN','10005','0002','W0005','C0005');
INSERT INTO QUARANTINEPATIENT  VALUES ('1006','M0006','768908347832',NULL,'Tan','0138746780','taman connounght',to_DATE('2020/09/06', 'yyyy/mm/dd'),'LOCAL','10006','0001','W0006','F0001');
INSERT INTO QUARANTINEPATIENT  VALUES ('1007','M0007','247389785739',NULL,'Gan','0127848974','cheras',to_DATE('2020/07/18', 'yyyy/mm/dd'),'LOCAL','10007','0001','W0007','F0002');
INSERT INTO QUARANTINEPATIENT  VALUES ('1008','M0008',NULL,'362798913490','ali','0190987654','huang tuah',to_DATE('2020/05/04', 'yyyy/mm/dd'),'FOREIGN','10008','0002','W0008','F0003');
INSERT INTO QUARANTINEPATIENT  VALUES ('1009','M0009','308564828934',NULL,'yee huan','0164783589','kepong',to_DATE('2020/07/20', 'yyyy/mm/dd'),'LOCAL','10009','0001','W0009','F0004');
INSERT INTO QUARANTINEPATIENT  VALUES ('1010','M0010','447832957104',NULL,'ilye','0174783456','selayang',to_DATE('2020/09/14', 'yyyy/mm/dd'),'LOCAL','10010','0001','W0010','F0005');

-- inserting PT_PCRTEST information
INSERT INTO RT_PCRTEST VALUES('T0001',to_DATE('2020/10/07', 'yyyy/mm/dd'),'C0001','POSITIVES');
INSERT INTO RT_PCRTEST VALUES('T0002',to_DATE('2020/10/07', 'yyyy/mm/dd'),'C0002','POSITIVES');
INSERT INTO RT_PCRTEST VALUES('T0003',to_DATE('2020/10/07', 'yyyy/mm/dd'),'C0003','POSITIVES');
INSERT INTO RT_PCRTEST VALUES('T0004',to_DATE('2020/10/07', 'yyyy/mm/dd'),'C0004','NEGATIVES');
INSERT INTO RT_PCRTEST VALUES('T0005',to_DATE('2020/10/07', 'yyyy/mm/dd'),'C0005','NEGATIVES');
INSERT INTO RT_PCRTEST VALUES('T0006',to_DATE('2020/10/08', 'yyyy/mm/dd'),'F0001','NEGATIVES');
INSERT INTO RT_PCRTEST VALUES('T0007',to_DATE('2020/10/08', 'yyyy/mm/dd'),'F0002','POSITIVES');
INSERT INTO RT_PCRTEST VALUES('T0008',to_DATE('2020/10/08', 'yyyy/mm/dd'),'F0003','NEGATIVES');
INSERT INTO RT_PCRTEST VALUES('T0009',to_DATE('2020/10/08', 'yyyy/mm/dd'),'F0004','POSITIVES');
INSERT INTO RT_PCRTEST VALUES('T0010',to_DATE('2020/10/08', 'yyyy/mm/dd'),'F0005','NEGATIVES');

-- inserting dependents information
INSERT INTO DEPENDENTS VALUES('Ali','000113011268','C0001','T0001');
INSERT INTO DEPENDENTS VALUES('Ahmad','000613011248','C0002','T0002');
INSERT INTO DEPENDENTS VALUES('Siti','000911011148','C0003','T0003');
INSERT INTO DEPENDENTS VALUES('Fatimah','000913011277','C0004','T0004');
INSERT INTO DEPENDENTS VALUES('William','000121011348','C0005','T0005');
INSERT INTO DEPENDENTS VALUES('Adrean','000813011238','F0001','T0006');
INSERT INTO DEPENDENTS VALUES('Ben','000330011299','F0002','T0007');
INSERT INTO DEPENDENTS VALUES('Chow','000401011538','F0003','T0008');
INSERT INTO DEPENDENTS VALUES('Jiale','000227011266','F0004','T0009');
INSERT INTO DEPENDENTS VALUES('Alice','000316011238','F0005','T0010');

-- inserting AUTHORIZED_OFFICER information
INSERT INTO AUTHORIZED_OFFICER VALUES('A0001','Daniel',to_DATE('2020/10/07 12:30:00', 'yyyy/mm/dd hh:mi:ss'),'Cosmo Hotel','C0001');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0002','Ali',to_DATE('2020/10/08 1:30:00', 'yyyy/mm/dd hh:mi:ss'),'Cosmo Hotel','C0002');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0003','Ben',to_DATE('2020/10/08 2:30:00', 'yyyy/mm/dd hh:mi:ss'),'Cosmo Hotel','C0003');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0004','Alan',to_DATE('2020/10/08 3:30:00', 'yyyy/mm/dd hh:mi:ss'),'Sungai Buluh Hospital','C0004');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0005','Tomas',to_DATE('2020/10/08 4:30:00', 'yyyy/mm/dd hh:mi:ss'),'Sungai Buluh Hospital','C0005');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0006','Lily',to_DATE('2020/10/09 1:30:00', 'yyyy/mm/dd hh:mi:ss'),'Sungai Buluh Hospital','F0001');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0007','Emily',to_DATE('2020/10/09 2:30:00', 'yyyy/mm/dd hh:mi:ss'),'Hotel Royal','F0002');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0008','Yuki',to_DATE('2020/10/10 3:30:00', 'yyyy/mm/dd hh:mi:ss'),'Sungai Buluh Hospital','F0003');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0009','Jack',to_DATE('2020/10/11 5:30:00', 'yyyy/mm/dd hh:mi:ss'),'Hotel Royal','F0004');
INSERT INTO AUTHORIZED_OFFICER VALUES('A0010','Felicia',to_DATE('2020/10/12 7:30:00', 'yyyy/mm/dd hh:mi:ss'),'Sungai Buluh Hospital','F0005');

-- inserting WRISTBAND information
INSERT INTO WRISTBAND VALUES('W0001','C0001','A0001','UNDAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0002','C0002','A0002','DAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0003','C0003','A0003','DAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0004','C0004','A0004','UNDAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0005','C0005','A0005','DAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0006','F0001','A0006','DAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0007','F0002','A0007','UNDAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0008','F0003','A0008','DAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0009','F0004','A0009','UNDAMAGED',NULL);
INSERT INTO WRISTBAND VALUES('W0010','F0005','A0010','UNDAMAGED',NULL);

-- inserting SYMPTOMS information
INSERT INTO SYMPTOMS VALUES ('YES','NO','NO','1001');
INSERT INTO SYMPTOMS VALUES ('YES','YES','NO','1002');
INSERT INTO SYMPTOMS VALUES ('YES','YES','YES','1003');
INSERT INTO SYMPTOMS  VALUES ('NO','YES','NO','1004');
INSERT INTO SYMPTOMS  VALUES ('NO','YES','YES','1005');
INSERT INTO SYMPTOMS  VALUES ('NO','NO','YES','1006');
INSERT INTO SYMPTOMS VALUES ('NO','NO','NO','1007');
INSERT INTO SYMPTOMS VALUES ('YES','NO','YES','1008');
INSERT INTO SYMPTOMS  VALUES ('YES','NO','NO','1009');
INSERT INTO SYMPTOMS  VALUES ('NO','NO','NO','1010');

-- inserting TYPEOFEXPOSURE information
INSERT INTO TYPEOFEXPOSURE VALUES ('0001');
INSERT INTO TYPEOFEXPOSURE VALUES ('0002');

ALTER TABLE QUARANTINEPATIENT
ADD CONSTRAINT fk_WRISTBANDIDa FOREIGN KEY (wristbandID) REFERENCES WRISTBAND(wristbandID)
ADD CONSTRAINT fk_TRAVELERh FOREIGN KEY(TravellerID) REFERENCES TRAVELER(TravellerID);

ALTER TABLE WRISTBAND
ADD CONSTRAINT fk_AUTHORIZED_OFFICER FOREIGN KEY(OfficerID) REFERENCES AUTHORIZED_OFFICER(OfficerID)
ADD CONSTRAINT fk_QUARANTINEPATIENT1 FOREIGN KEY(patientID) REFERENCES QUARANTINEPATIENT(patientID)
ADD CONSTRAINT fk_TRAVELERd FOREIGN KEY(TravellerID) REFERENCES TRAVELER(TravellerID);

ALTER TABLE DEPENDENTS
ADD CONSTRAINT fk_TID FOREIGN KEY(TestID) REFERENCES RT_PCRTEST(TestID)
ADD CONSTRAINT fk_TRAVELERa FOREIGN KEY(TravellerID) REFERENCES TRAVELER(TravellerID);

ALTER TABLE AUTHORIZED_OFFICER
ADD CONSTRAINT fk_TRAVELERc FOREIGN KEY(TravellerID) REFERENCES TRAVELER(TravellerID);

ALTER TABLE RT_PCRTEST
ADD CONSTRAINT fk_TRAVELERb FOREIGN KEY(TravellerID) REFERENCES TRAVELER(TravellerID)
ADD CONSTRAINT fk_TID_PCRTEST FOREIGN KEY(TestID) REFERENCES RT_PCRTEST(TestID);

ALTER TABLE SYMPTOMS
ADD CONSTRAINT fk_QUARANTINEPATIENT FOREIGN KEY(patientID) REFERENCES QUARANTINEPATIENT(patientID);